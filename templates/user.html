{% extends 'base.html' %}
{% block content %}

  <div id="show-user-info">
    <h1>{{ user.name }}</h1>
    <p>({{ user.user_id }})<p>
    <p><b>Email:</b> {{ user.email }}</p>
    <p><b>Age:</b> {{ user.age }}</p>
    <p><b>Residency Address:</b> {{ user.residency_address }}</p>
    <p><b>Zipcode:</b> {{ user.zipcode }}</p>
    <p><b>Allergies:</b> {{ user.allergies }}</p>
    <p><b>Medications:</b> {{ user.medications }}</p>
    <p><b>Phone:</b> {{ user.phone }}</p>
  </div>

<!------------------------------ EDIT USER FORM  ---------------------------------->
  <button type="button" id="edit-user-form-button">Edit</button>
  <form id="user-edit-form" class="edit-form-hidden" action="/users/{{ user.user_id }}" method="POST">
    <p><b>Name:</b></p>
    <input class="user-name" type="text" value="{{ user.name }}" name="name">
    <p><b>Email:</b></p>
    <input class="user-email" type="text" value="{{ user.email }}" name="email">
    <p><b>Age:</b></p>
    <input class="user-age" type="text" value="{{ user.age }}" name="age">
    <p><b>Residency Address:</b></p>
    <input class="user-address" type="text" value="{{ user.residency_address }}" name="residency_address">
    <p><b>Zipcode:</b></p>
    <input class="user-zipcode" type="text" value="{{ user.zipcode }}" name="zipcode">
    <p><b>Allergies:</b></p>
    <input class="user-allergies" type="text" value="{{ user.allergies }}" name="allergies">
    <p><b>Medications:</b></p>
    <input class="user-medications" type="text" value="{{ user.medications }}" name="medications">
    <p><b>Phone:</b></p>
    <input class="user-phone" type="text" value="{{ user.phone }}" name="phone">
    <input type="hidden" class="user-id" name="user-id" value="{{ user.user_id }}">
    <input type="submit" id="submit" value="Save"></input>
  </form>

<!------------------------------ SHOW CONTACTS  ---------------------------------->
  {% if user.contacts %}
  <h2>Contacts</h2>

    <ul class="user-contacts">
    {% for contact in user.contacts %}
      <a href="/contacts/{{ contact.contact_id }}"> {{ contact.name }} </a>
      <ul>
      {% for phone in contact.phones %}
          <li>{{ phone.type }}: {{ phone.phone }}</li>
        <!------------------------------ EDIT CONTACT FORM  ---------------------------------->
          <button type="button" class="edit-contact-button" id="{{ contact.contact_id }}">Edit</button>
          <form class="edit-form-hidden" id="contact-edit-form-{{ contact.contact_id }}" action="/contacts/{{ contact.contact_id }}" method="POST">
            <p><b>Name:</b></p>
            <input class="edit-contact-name" type="text" value="{{ contact.name }}" name="name">
            <p><b>Type:</b></p>
            <input class="edit-contact-type" type="text" value="{{ phone.type }}" name="type">
            <p><b>Phone:</b></p>
            <input class="edit-contact-phone" type="text" value="{{ phone.phone }}" name="phone">
            <input type="hidden" class="contact-id" name="contact-id" value="{{ contact.contact_id }}">
            <input type="submit" id="submit" value="Save"></input>
          </form>
      {% endfor %}
      </ul>
    {% endfor %}
    </ul>
  {% endif %}

  <form action="/tests" method="POST">
    <input type="submit" id="invite-button" value="Test a message to yourself"></input>
  </form>

<!------------------------------ ADD CONTACT FORM  ---------------------------------->
  <h3>Add a contact:</h3>

  <form id="add-contact-form" action="/contacts" method="POST">
    <div>
      <label>
        Name
        <input class="contact-name" type="text" name="name">
      </label>
    </div>

    <div>
      <label>
        Type
        <input class="phone-type" type="text" name="type">
      </label>
    </div>

    <div>
      <label>
        Phone
        <input class="contact-phone" type="text" name="phone">
      </label>
    </div>

    <div>
      <input type="submit" value="Add">
    </div><br>
  </form>


<!------------------------------ ADD EARTHQUAKE ALERT SETTING ---------------------------------->
  <h2>Earthquake Alert Settings:</h2>

  <!-- TODO: Toggle button on/off alert -->
  <!-- <label class="checkbox-inline">
    <input type="checkbox" checked data-toggle="toggle"> Toggle Button
  </label> -->

  <div>
    <h3>Magnitude Level</h3>
    <p id="mag-user-value"><p>
  </div>

<!-- TODO: Refactor model.py to store user's settings -->
  <form id="earthquake-form" action="/settings/eqmag" method="POST">
    <select name="magnitude">
        <option value="4.5">4.5 or higher</option>
        <option value="2.5">2.5 or higher</option>
    </select>
    <br><br>
    <input type="hidden" class="setting-code" name="setting_code" value="eqmag">
    <input type="submit" value="Submit">
  </form><br><br>

  <div id="map"></div>

<script async defer src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_KEY }}&callback=initMap">
</script>
<script src="/static/js/maps.js"></script>

{% endblock %}
